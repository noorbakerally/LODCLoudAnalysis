http://www.icefox.net/articles/typemanager.php
